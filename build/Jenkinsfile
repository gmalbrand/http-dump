pipeline {
    agent { label 'go' }
    tools {
      go 'go-1.19.3'
    }
    stages {
        stage('Go : Download modules') {
          steps {
            dir("${env.WORKSPACE}/src"){
              sh 'go mod download'
            }
          }
        }
        stage('Go : Build executable') {
          steps{
            dir("${env.WORKSPACE}/src"){
              sh 'go build -o http-dump main.go'
            }
          }
        }
        stage('Env : List environment variables') {
          steps {
              sh 'echo $PWD'
              sh 'printenv'
          }
        }
        logstashSend failBuild: false, maxLines: 1000
    }
}
